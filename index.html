<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>DieUhr</title>
<link href="design.css" rel="stylesheet"/>
<link href="display.css" rel="stylesheet"/>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/clock.js"></script>
<script type="text/javascript" src="js/function.js"></script>
</head>
<body>
	<div class="onOff" style="float: right;">
		<button id="switch" type="button" ><img src="svg/OnOff.svg" /></button>
	</div>
	<!--div class="button" style="float: right; margin-right: 2vw;">
		<button id= "refresh" type="button" style="background-color:#FFFF66; "><img src="svg/refresh.svg" ></button>
	</div-->
<ul id="tab" class="tabrow">
  <li><input type="button" name="Vorschau" value="Vorschau"/></li>
  <li><input type="button" name="Live"     value="Live"/></li>
</ul>
	<div class="boxw" style="margin-top: 0;">
		<div id="clock">
			<div id="displayTime">
				<span class="the_clock">
					<span class="cl_hours"></span><span class="cl_minutes"></span>
				</span>
			</div>
			<div id="displayText">
				<span class='the_message'>
				</span>
			</div>
			<div id="displayDate">
				<span class='the_date'>
					<span class='cl_day'></span><span class='cl_month'></span><span class='cl_year'></span>
				</span>
			</div>
		</div>	
	</div>
	<div id="error"></div>
	<div class="boxw">
		<div style="margin:0; padding:0 1vw; float: left;">
			<select id="mode" style="width: 43.5vw;">
				<option value="textblock" >Textblock</option>
				<option value="marquee"   >Laufschrift</option>
			</select>
			<select id="timer" style="width: 20vw;">
				<option value="60"  >1 Min</option>
				<option value="180" >3 Min</option>
				<option value="300" >5 Min</option>
				<option value="600" >10Min</option>
				<option value="inf" >&#8734;</option>
			</select>
			<select id="symbol" style="width: 20vw;" >
				<option value="">&#10047;&#10084;</option>
				<option value="&#10047;" >&#10047;</option>
				<option value="&#10049;" >&#10049;</option>
				<option value="&#10084;" >&#10084;</option>
				<option value="&#10082;" >&#10082;</option>
				
				<option value="&#10017;" >&#10017;</option>
				<option value="&#10032;" >&#10032;</option>
				<option value="&#10038;" >&#10038;</option>
				<option value="&#10039;" >&#10039;</option>
				
				<option value="&#937;"  >&#937; </option>
				<option value="&#9986;" >&#9986;</option>
				<option value="&#9990;" >&#9990;</option>
				<option value="&#9993;" >&#9993;</option>
				
				<option value="&#10003;">&#10003;</option>
				<option value="&#10007;">&#10007;</option>
				<option value="&#8635;" >&#8635; </option>
				<option value="&#10132;">&#10132;</option>
			</select>		
		</div>
		<textarea id="message" name="message" ></textarea>

		<div class="button" style="float: left;">
			<button id="new" type="button" style="background-color:#FFFF66;"><img src="svg/doc.svg"/></button>
		</div>
		<div id="load" class="button" style="float: left;">
			<button type="button" style="background-color:#FFFF66" ><img src="svg/load.svg"/></button>
		</div>
		<div id="save" class="button" style="float: left;">
			<button type="button" style="background-color:#FFFF66" ><img src="svg/save.svg"/></button>
		</div>
		<div id="del" class="button" style="float: left;">
			<button type="button" style="background-color:#FFFF66;"><img src="svg/delete.svg"/></button>
		</div>
		<div id="bth" style="margin:0; padding:0;">
		<div class="button" style="float: left;">
			<button id="revert" type="button" style="background-color:#FF7755;"><img src="svg/back.svg" /></button>
		</div>
		<div class="button" style="float: left;">
			<button id="confirm" type="button" style="background-color:#99DD55;"><img src="svg/done.svg"/></button>
		</div>
		</div>
	</div>
<script>
$("#error").hide();
$("#bth").hide();
$(".displayText").hide();
$(".displayDate").hide();

var local = {
	tab:	"Vorschau",
	mode:	"textblock",
	timer:	"300",
	message:"Das Lied Nr.: ",
	onOff:  ""
};

var temp = {
	tab:	"",
	mode:	"",
	timer:	"",
	message:"",
	onOff:  ""
};

var remote = {
	tab:	"",
	mode:	"",
	timer:	"",
	message:"",
	onOff:  ""
};

function timeloop() {
	getDisplay(); // more function after ajax respond
	startClock();
	setTimeout("timeloop()",1000);
};
timeloop();

$("input[name='Vorschau']").parent().addClass("selected"); // set tab
$("#message").val(local.message); // set message
$("#timer option[value='180']").prop("selected", true)




$("#tab input").click(function(){ // tab buttons
	local.tab = $(this).val();
	$("#tab").children("li").removeClass("selected");
	$(this).parent().addClass("selected");
	checkDisplay();
});

$('#switch').click(function(){ // toggel on off switch
	$(this).addClass("grayButton");
	temp = remote;
	if (remote.onOff == 'on') {
		temp.onOff ='off';
	} else {
		temp.onOff ='on';
	} 
	sendDisplay(temp);
	checkDisplay();
});

$("#mode").change(function(){ // dropdown mode
	local.mode = $("#mode option:selected").val();
	checkDisplay();
});

$("#timer").change(function(){ // dropdown timer
	local.timer = $( "#timer option:selected" ).val();
});

$("#symbol").change(function(){ // dropdown symbol
	local.message = $("#message").val() + $( "#symbol option:selected" ).val();
	$("#symbol option:selected").prop("selected", false)
	$("#symbol option[value='']").prop("selected", true)
	$("#message").val(local.message);
	checkDisplay();
	
});

$('#message').bind('keyup',function(){ //textarea
	local.message = $("#message").val();
	checkDisplay();
});

$('#load').click(function(){ // load button
	local = JSON.parse(getCookie('DieUhr'));
	$("#message").val(local.message);
	$("#timer").val(local.timer);
	$("#mode").val(local.mode);
	checkDisplay();
});

$('#save').click(function(){ // save button
	setCookie('DieUhr', JSON.stringify(local));
});

$('#new').click(function(){ // template button
	local.message = "Das Lied Nr.: ";
	$("#message").val(local.message);
	checkDisplay();
});

$('#del').click(function(){ // trash button
	local.message = "";
	$("#message").val(local.message);
	checkDisplay();
});

$("#confirm").click(function(){ //confirm button
	$(this).addClass("grayButton");
	local.onOff = remote.onOff;
	sendDisplay(local);
	checkDisplay();
});

$("#revert").click(function(){ //revert button
	$(this).addClass("grayButton");
	$.ajax({
	url: "data.json",
	cache: false
	})
	.done(function(response) {
		$("#revert").removeClass("grayButton");
		local = response;
		$("#message").val(local.message);
		$("#timer").val(local.timer);
		$("#mode").val(local.mode);
		checkDisplay();
	});
});
</script>
</body>
</html>
